define(["require","underscore","./excel/Workbook","JSZip"],function(f,g,h,k){return{createWorkbook:function(){return new h},createFileAsync:function(e,a){e.generateFilesAsync({success:function(b){var d=new Worker(f.toUrl("./Excel/ZipWorker.js"));d.addEventListener("message",function(b,c){"done"==b.data.status&&a.success(b.data.data)});d.postMessage({files:b,ziplib:f.toUrl("JSZip"),base64:!a||!1!==a.base64})},error:function(){a.error()}})},createFile:function(e,a){var b=new k,d=e.generateFiles();g.each(d,
function(a,c){c=c.substr(1);-1!==c.indexOf(".xml")||-1!==c.indexOf(".rel")?b.file(c,a,{base64:!1}):b.file(c,a,{base64:!0,binary:!0})});return b.generate(g.defaults(a||{},{type:"base64"}))}}});